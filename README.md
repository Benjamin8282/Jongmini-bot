# 🐣 종미니 (Jongmini Bot)

네오플 DNF API를 활용해 던전앤파이터 캐릭터의 타임라인을 주기적으로 조회하고,  
아이템 획득 이벤트를 감지하여 디스코드 지정 채널에 자동으로 축하 메시지를 전송하는 디스코드 봇입니다.

---

## ✨ 주요 기능

- `/hello` : 슬래시 커맨드로 종미니가 인사합니다  
- `/등록 <서버> <캐릭터명>` : 캐릭터를 등록하여 타임라인 감시 시작  
- `/출력` : 득템 알림을 받을 디스코드 채널을 등록  
- 타임라인의 득템 이벤트 감지 및 자동 축하 메시지 전송 (장착 가능 레벨 115 아이템 대상)  
- 다중 캐릭터 관리 및 중복 득템 방지 (마지막 조회 시간 기준)  
- 모험단별 일간 아이템 획득량 집계 및 순위 표시 기능 추가 (매일 오전 6시 자동 집계)

---

## 🛠 사용 기술

- `discord.py` 2.x (슬래시 커맨드, 봇 인터페이스)  
- `aiohttp` (DNF Open API 비동기 호출)  
- `asyncio` (비동기 주기적 감시 및 작업 처리)  
- `aiosqlite` (SQLite 비동기 DB, 캐시 및 사용자/채널 정보 관리)  
- `dotenv` (환경 변수 관리)  
- Python 3.11+  
- Docker & Portainer (컨테이너 기반 자동 배포 및 운영)

---

## 🚀 자동 배포 및 운영

- **GitHub Actions**를 이용해 소스코드 변경 시 자동으로 도커 이미지 빌드 및 도커허브에 푸시  
- Portainer를 통한 컨테이너 관리로 자동 최신 이미지 풀링 및 손쉬운 재배포 가능  
- 도커 볼륨을 활용해 DB 및 로그 데이터 영속성 확보  
- 컨테이너 재생성(Recreate) 시 기존 데이터 유지 및 무중단 업데이트 가능  
- 배포 스크립트와 워크플로우는 `.github/workflows/` 경로에 정의되어 있음

---

## 🎯 개발 목표

- 실시간 득템 로그를 감지하여 유저와 커뮤니티에 빠른 알림 제공  
- 개인/길드용 봇으로 확장 가능하도록 구조화  
- Python 비동기 프로그래밍과 Discord 봇 개발 역량 강화 및 포트폴리오 구축  

---

## 🗂 주요 구조 및 파일

- `core/db.py` : DB 초기화, 캐릭터 및 채널 정보 저장/조회, 아이템 캐시 관리  
- `core/dnf_api.py` : DNF API 호출 및 아이템 상세정보 캐싱  
- `commands/` : 슬래시 커맨드 모음 (`/hello`, `/등록`, `/출력` 등)  
- `tasks/notify_items.py` : 주기적 타임라인 감시 및 아이템 득템 알림 작업  
- `tasks/daily_aggregation.py` : 모험단별 일간 아이템 획득량 집계 및 순위 계산 작업  
- `main.py` : 봇 초기화 및 실행, 작업 스케줄링 관리  
- `.github/workflows/` : GitHub Actions 자동 배포 워크플로우

---

## 📝 기타

- API 키 등 민감 정보는 `.env` 파일에서 관리  
- DB 파일은 도커 볼륨 `/app/data/characters.db` 경로에 저장 (데이터 영속성 보장)  
- 기능 및 명령어는 지속적으로 확장 예정  

---

## 🙋‍♂️ 개발자

**강종우**  
- Android Native(JAVA,Kotlin) & Python Developer  
- [GitHub](https://github.com/Benjamin8282)  
- Email: kangjongwoo333@gmail.com

---
